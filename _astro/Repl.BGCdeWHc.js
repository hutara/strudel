import{j as e}from"./jsx-runtime.CLpGMVip.js";import{n as Be,m as Q,u as N,r as $e,o as Ue,q as He,v as Ke,w as A,c as we,x as M,y as g,z as We,A as ze,B as q,C as Ze,D as _,E as Ve,p as ee,F as je,G as D,H as Ge,I as Xe,b as qe,J as Ye,K as Je,L as Qe,s as et,h as F,M as B,N as tt,O as ce,P as nt,g as st,Q as rt,R as at,S as ot}from"./util.DxGMlc5p.js";import{c as v,A as it,a as lt}from"./PatternsTab.BNdhz_MG.js";import{u as ye}from"./useEvent.CgYsmZOj.js";import{l as Y,e as ct,D as dt,$ as ut}from"./index.D1tCthlq.js";import{q as mt,g as Ce}from"./index.DmSyaW3g.js";import{r as m,R as ht}from"./index.B9mnsnPE.js";import{j as pt,y as ft,S as gt,w as xt,z as de}from"./codemirror.Cfeuy1TC.js";import{e as bt,s as vt,f as wt,D as jt,h as ue,g as me,j as yt,i as Ct,w as Et,k as Nt,l as Tt,m as St,n as kt}from"./spectrum.3xUQRZ8h.js";/* empty css                      */import{clearHydra as he}from"./hydra.gpAyA9If.js";import{oscTrigger as Pt}from"./osc.BQLdUe1R.js";import"./preload-helper.CLcXU_4U.js";import"./_commonjsHelpers.BosuxZz1.js";function te({onChange:t,className:n,...s}){return e.jsx("input",{className:v("p-2 bg-background rounded-md  border-foreground text-foreground placeholder-foreground",n),onChange:r=>t(r.target.value),...s})}function ne({active:t}){return e.jsx("div",{className:"overflow-hidden opacity-50 fixed top-0 left-0 w-full z-[1000]",children:e.jsx("div",{className:v("h-[2px] block w-full",t?"bg-foreground animate-train":"bg-transparent"),children:e.jsx("div",{})})})}const J=mt([]);function Rt(t){ye(Y.key,t)}function _t(t,n){const{message:s,type:r,data:a}=n.detail,c=t.length?t[t.length-1]:void 0,h=Be(12);if(r==="loaded-sample"){const d=t.findIndex(({data:{url:f},type:i})=>i==="load-sample"&&f===a.url);t[d]={message:s,type:r,id:h,data:a}}else c&&c.message===s?t=t.slice(0,-1).concat([{message:s,type:r,count:(c.count??1)+1,id:h,data:a}]):t=t.concat([{message:s,type:r,id:h,data:a}]);return t.slice(-20)}function At(){Rt(t=>{const n=J.get(),s=_t(n,t);J.set(s)})}function Mt(){const t=Q(J),{fontFamily:n}=N();return e.jsx("div",{id:"console-tab",className:"break-all w-full  first-line:text-sm p-2  h-full",style:{fontFamily:n},children:e.jsx("div",{className:"bg-background h-full w-full overflow-auto space-y-1 p-2 rounded-md",children:t.map((s,r)=>{const a=Ot(s.message),c=s.data?.hap?.value?.color;return e.jsxs("div",{className:v(s.type==="error"?"text-background bg-foreground":"text-foreground",s.type==="highlight"&&"underline"),style:c?{color:c}:{},children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:a}}),s.count?` (${s.count})`:""]},s.id)})})})}function Ot(t){var n,s,r,a;return s=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,n=t.replace(s,'<a class="underline" href="$1" target="_blank">$1</a>'),r=/(^|[^\/])(www\.[\S]+(\b|$))/gim,n=n.replace(r,'$1<a class="underline" href="http://$2" target="_blank">$2</a>'),a=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,n=n.replace(a,'<a class="underline" href="mailto:$1">$1</a>'),n}function Dt(){const[t,n]=m.useState([]);m.useEffect(()=>($e("",{dir:Ue,recursive:!0}).then(d=>n([{name:"~/music",children:d}])).catch(d=>{console.log("error loadin files",d)}),()=>{}),[]);const s=m.useMemo(()=>t[t.length-1],[t]),r=m.useMemo(()=>t.slice(1).map(d=>d.name).join("/"),[t]),a=m.useMemo(()=>s?.children.filter(d=>!!d.children),[s]),c=m.useMemo(()=>s?.children.filter(d=>!d.children&&He(d.name)),[s]),h=d=>n(f=>f.concat([d]));return e.jsxs("div",{className:"px-4 flex flex-col h-full",children:[e.jsx("div",{className:"flex justify-between font-mono pb-1",children:e.jsxs("div",{children:[e.jsx("span",{children:"samples('"}),t?.map((d,f)=>f<t.length-1?e.jsxs(m.Fragment,{children:[e.jsx("span",{className:"cursor-pointer underline",onClick:()=>n(i=>i.slice(0,f+1)),children:d.name}),e.jsx("span",{children:"/"})]},f):e.jsx("span",{className:"cursor-pointer underline",children:d.name},f)),e.jsx("span",{children:"')"})]})}),e.jsxs("div",{className:"overflow-auto",children:[!a?.length&&!c?.length&&e.jsx("span",{className:"text-gray-500",children:"Nothing here"}),a?.map((d,f)=>e.jsx("div",{className:"cursor-pointer",onClick:()=>h(d),children:d.name},f)),c?.map((d,f)=>e.jsx("div",{className:"text-gray-500 cursor-pointer select-none",onClick:async()=>Ke(`${r}/${d.name}`),children:d.name},f))]})]})}const Lt=({name:t,description:n})=>t&&!t.startsWith("_")&&!!n,It=(()=>{const t=new Set,n=[];for(const s of pt.docs){if(!Lt(s))continue;n.push(s);const r=s.synonyms||[];for(const a of r){if(!a||t.has(a))continue;t.add(a);const c=[s.name,...r].filter(h=>h&&h!==a);n.push({...s,name:a,longname:a,synonyms:c,synonyms_text:c.join(", ")})}}return n.sort((s,r)=>s.name.localeCompare(r.name))})(),Ft=t=>{var n=document.createElement("div");return n.innerHTML=t,n.textContent||n.innerText||""};function Bt(){const[t,n]=m.useState(""),s=m.useMemo(()=>It.filter(r=>{if(!t)return!0;const a=t.toLowerCase();return r.name.toLowerCase().includes(a)||(r.synonyms?.some(c=>c.toLowerCase().includes(a))??!1)}),[t]);return e.jsxs("div",{className:"flex h-full w-full p-2 overflow-hidden",style:{direction:"rtl"},children:[e.jsxs("div",{className:"h-full Â flex flex-col gap-2 w-1/3 max-w-72 ",children:[e.jsx("div",{class:"w-full flex",children:e.jsx(te,{className:"w-full",placeholder:"Ø¬Ø³ØªØ¬Ùˆ",value:t,onChange:n})}),e.jsx("div",{className:"flex flex-col h-full overflow-y-auto Â gap-1.5 bg-background bg-opacity-50 Â rounded-md",children:s.map((r,a)=>e.jsxs("a",{className:"cursor-pointer text-foreground flex-none hover:bg-lineHighlight overflow-x-hidden Â px-1 text-ellipsis",onClick:()=>{const c=document.getElementById(`doc-${a}`);document.getElementById("reference-container").scrollTo(0,c.offsetTop)},children:[r.name," "]},a))})]}),e.jsx("div",{className:"break-normal flex-grow flex-col overflow-y-auto overflow-x-hidden Â  px-2 flex relative",id:"reference-container",style:{textAlign:"right"},children:e.jsxs("div",{className:"prose dark:prose-invert min-w-full px-1 ",children:[e.jsx("h2",{children:"Ù…Ø±Ø¬Ø¹ API"}),e.jsx("p",{children:"Ø§ÛŒÙ† Ù„ÛŒØ³Øª Ø¨Ù„Ù†Ø¯ Ø§Ø² ØªÙˆØ§Ø¨Ø¹ÛŒ Ø§Ø³Øª Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø¢Ù†Ù‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ø¨Ù‡ Ø®Ø§Ø·Ø± Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ù†ÛŒØ§Ø²ÛŒ Ù†ÛŒØ³Øª Ù‡Ù…Ù‡ Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ø­ÙØ¸ Ú©Ù†ÛŒØ¯ Ùˆ Ø¨Ø§ Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÛŒ Ú©ÙˆÚ†Ú©ÛŒ Ø§Ø² ØªÙˆØ§Ø¨Ø¹ Ù†ÛŒØ² Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…ÙˆØ³ÛŒÙ‚ÛŒ Ø¨Ø³Ø§Ø²ÛŒØ¯!"}),s.map((r,a)=>e.jsxs("section",{children:[e.jsx("h3",{id:`doc-${a}`,children:r.name}),!!r.synonyms_text&&e.jsxs("p",{children:["Ù…ØªØ±Ø§Ø¯Ùâ€ŒÙ‡Ø§ (Synonyms): ",e.jsx("code",{children:r.synonyms_text})]}),e.jsx("p",{dangerouslySetInnerHTML:{__html:r.description}}),e.jsx("ul",{children:r.params?.map(({name:c,type:h,description:d},f)=>e.jsxs("li",{children:[c," : ",h?.names?.join(" | ")," ",d?e.jsxs(e.Fragment,{children:[" - ",Ft(d)]}):""]},f))}),r.examples?.map((c,h)=>e.jsx("pre",{className:"bg-background",style:{direction:"ltr",textAlign:"left"},children:c},h))]},a))]})})]})}function K({value:t,onChange:n,items:s}){return e.jsx("div",{className:"flex max-w-lg",children:Object.entries(s).map(([r,a],c,h)=>e.jsx("button",{id:r,onClick:()=>n(r),className:v("px-2 border-b h-8 whitespace-nowrap",t===r?"border-foreground":"border-transparent"),children:a.toLowerCase()},r))})}function Ee({value:t,options:n,onChange:s,onClick:r,isDisabled:a}){return e.jsxs("select",{disabled:a,onClick:r,className:"p-2 bg-background rounded-md text-foreground  border-foreground",value:t??"",onChange:c=>s(c.target.value),children:[n.size==0&&e.jsx("option",{value:t,children:`${t??"select an option"}`}),Array.from(n.keys()).map(c=>e.jsx("option",{className:"bg-background",value:c,children:n.get(c)},c))]})}const $t=new Map;function Ut({audioDeviceName:t,onChange:n,isDisabled:s}){const[r,a]=m.useState($t),c=r.size>0,h=()=>{c||bt().then(i=>{a(i)})},d=i=>{c&&n(i)},f=new Map;return Array.from(r.keys()).forEach(i=>{f.set(i,i)}),e.jsx(Ee,{isDisabled:s,options:f,onClick:h,value:t,onChange:d})}function Ht({target:t,onChange:n,isDisabled:s}){const r=c=>{n(c)},a=new Map([[A.webaudio,A.webaudio],[A.osc,A.osc]]);return e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsx(Ee,{isDisabled:s,options:a,value:t,onChange:r}),t===A.osc&&e.jsx("div",{children:e.jsxs("p",{className:"text-sm italic",children:["âš  All events routed to OSC, audio is silenced! See"," ",e.jsx("a",{className:"text-blue-500",href:"https://strudel.cc/learn/input-output/",children:"Docs"})]})})]})}function y({label:t,value:n,onChange:s,disabled:r=!1}){return e.jsxs("label",{children:[e.jsx("input",{disabled:r,type:"checkbox",checked:n,onChange:s})," "+t]})}function pe({value:t,options:n,onChange:s}){return e.jsx("select",{className:"p-2 bg-background rounded-md text-foreground  border-foreground",value:t,onChange:r=>s(r.target.value),children:Object.entries(n).map(([r,a])=>e.jsx("option",{className:"bg-background",value:r,children:a},r))})}function Kt({value:t,onChange:n,step:s=1,...r}){return e.jsxs("div",{className:"flex space-x-2 gap-1",children:[e.jsx("input",{className:"p-2 grow",type:"range",value:t,step:s,onChange:a=>n(Number(a.target.value)),...r}),e.jsx("input",{type:"number",value:t,step:s,className:"w-16 bg-background rounded-md",onChange:a=>n(Number(a.target.value))})]})}function C({label:t,children:n,sublabel:s}){return e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{children:t}),n]})}const Wt=Object.fromEntries(Object.keys(ft).map(t=>[t,t])),zt={monospace:"monospace",Courier:"Courier",CutiePi:"CutiePi",JetBrains:"JetBrains",Hack:"Hack",FiraCode:"FiraCode","FiraCode-SemiBold":"FiraCode SemiBold",teletext:"teletext",tic80:"tic80",mode7:"mode7",BigBlueTerminal:"BigBlueTerminal",x3270:"x3270",Monocraft:"Monocraft",PressStart:"PressStart2P","we-come-in-peace":"we-come-in-peace",galactico:"galactico"},$="Changing this setting requires the window to reload itself. OK?";function Zt({started:t}){const{theme:n,keybindings:s,isBracketClosingEnabled:r,isBracketMatchingEnabled:a,isLineNumbersDisplayed:c,isPatternHighlightingEnabled:h,isActiveLineHighlighted:d,isAutoCompletionEnabled:f,isTooltipEnabled:i,isFlashEnabled:o,isButtonRowHidden:u,isCSSAnimationDisabled:p,isSyncEnabled:b,isLineWrappingEnabled:S,fontSize:k,fontFamily:P,panelPosition:z,audioDeviceName:L,audioEngineTarget:Z,togglePanelTrigger:I,maxPolyphony:ae,multiChannelOrbits:oe,isTabIndentationEnabled:ie,isMultiCursorEnabled:w}=N(),j=we(),O=AudioContext.prototype.setSinkId!=null;return e.jsxs("div",{className:"text-foreground p-4 space-y-4 w-full",style:{fontFamily:P},children:[O&&e.jsx(C,{label:"Audio Output Device",children:e.jsx(Ut,{isDisabled:t,audioDeviceName:L,onChange:l=>{M($).then(x=>{if(x==!0)return g.setKey("audioDeviceName",l),window.location.reload()})}})}),e.jsx(C,{label:"Audio Engine Target",children:e.jsx(Ht,{target:Z,onChange:l=>{M($).then(x=>{if(x==!0)return g.setKey("audioEngineTarget",l),window.location.reload()})}})}),e.jsx(C,{label:"Maximum Polyphony",children:e.jsx(te,{min:1,max:1/0,onBlur:l=>{let x=parseInt(l.target.value);x=isNaN(x)?jt:x,vt(x),g.setKey("maxPolyphony",x)},onChange:l=>{l=Math.max(1,parseInt(l)),g.setKey("maxPolyphony",isNaN(l)?void 0:l)},type:"number",placeholder:"",value:ae??""})}),e.jsx(C,{children:e.jsx(y,{label:"Multi Channel Orbits",onChange:l=>{const x=l.target.checked;M($).then(E=>{if(E==!0)return g.setKey("multiChannelOrbits",x),wt(x),window.location.reload()})},value:oe})}),e.jsx(C,{label:"Theme",children:e.jsx(pe,{options:Wt,value:n,onChange:l=>g.setKey("theme",l)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 font-sans",children:[e.jsx(C,{label:"Font Family",children:e.jsx(pe,{options:zt,value:P,onChange:l=>g.setKey("fontFamily",l)})}),e.jsx(C,{label:"Font Size",children:e.jsx(Kt,{value:k,onChange:l=>g.setKey("fontSize",l),min:10,max:40,step:2})})]}),e.jsx(C,{label:"Keybindings",children:e.jsx(K,{value:s,onChange:l=>g.setKey("keybindings",l),items:{codemirror:"Codemirror",vim:"Vim",emacs:"Emacs",vscode:"VSCode"}})}),e.jsx(C,{label:"Panel Position",children:e.jsx(K,{value:z,onChange:l=>g.setKey("panelPosition",l),items:{bottom:"Bottom",right:"Right"}})}),e.jsx(C,{label:"Open Panel on:                       ",children:e.jsx(K,{value:I,onChange:l=>g.setKey("togglePanelTrigger",l),items:{click:"Click",hover:"Hover"}})}),e.jsxs(C,{label:"More Settings",children:[e.jsx(y,{label:"Enable bracket matching",onChange:l=>g.setKey("isBracketMatchingEnabled",l.target.checked),value:a}),e.jsx(y,{label:"Auto close brackets",onChange:l=>g.setKey("isBracketClosingEnabled",l.target.checked),value:r}),e.jsx(y,{label:"Display line numbers",onChange:l=>g.setKey("isLineNumbersDisplayed",l.target.checked),value:c}),e.jsx(y,{label:"Highlight active line",onChange:l=>g.setKey("isActiveLineHighlighted",l.target.checked),value:d}),e.jsx(y,{label:"Highlight events in code",onChange:l=>g.setKey("isPatternHighlightingEnabled",l.target.checked),value:h}),e.jsx(y,{label:"Enable auto-completion",onChange:l=>g.setKey("isAutoCompletionEnabled",l.target.checked),value:f}),e.jsx(y,{label:"Enable tooltips on Ctrl and hover",onChange:l=>g.setKey("isTooltipEnabled",l.target.checked),value:i}),e.jsx(y,{label:"Enable line wrapping",onChange:l=>g.setKey("isLineWrappingEnabled",l.target.checked),value:S}),e.jsx(y,{label:"Enable Tab indentation",onChange:l=>g.setKey("isTabIndentationEnabled",l.target.checked),value:ie}),e.jsx(y,{label:"Enable Multi-Cursor (Cmd/Ctrl+Click)",onChange:l=>g.setKey("isMultiCursorEnabled",l.target.checked),value:w}),e.jsx(y,{label:"Enable flashing on evaluation",onChange:l=>g.setKey("isFlashEnabled",l.target.checked),value:o}),e.jsx(y,{label:"Sync across Browser Tabs / Windows",onChange:l=>{const x=l.target.checked;M($).then(E=>{E&&(g.setKey("isSyncEnabled",x),window.location.reload())})},disabled:j,value:b}),e.jsx(y,{label:"Hide top buttons",onChange:l=>g.setKey("isButtonRowHidden",l.target.checked),value:u}),e.jsx(y,{label:"Disable CSS Animations",onChange:l=>g.setKey("isCSSAnimationDisabled",l.target.checked),value:p})]}),e.jsx(C,{label:"Zen Mode",children:"Try clicking the logo in the top left!"}),e.jsx(C,{label:"Reset Settings",children:e.jsx("button",{className:"bg-background p-2 max-w-[300px] rounded-md hover:opacity-50",onClick:()=>{M("Sure?").then(l=>{if(l){const{userPatterns:x}=g.get();g.set({...We,userPatterns:x})}})},children:"restore default settings"})})]})}function Vt({onComplete:t}){let n=ht.createRef();const[s,r]=m.useState(!1),a=m.useCallback(async()=>{n.current.files?.length&&(r(!0),await ze(q,n.current.files).then(()=>{Ze(q,()=>{t(),r(!1)})}))});return e.jsx("div",{children:e.jsxs("label",{style:{alignItems:"center",borderColor:"red",border:1},className:"flex bg-background  p-4  w-fit rounded-xl hover:opacity-50 whitespace-nowrap cursor-pointer",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6 mr-2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 7.5h-.75A2.25 2.25 0 0 0 4.5 9.75v7.5a2.25 2.25 0 0 0 2.25 2.25h7.5a2.25 2.25 0 0 0 2.25-2.25v-7.5a2.25 2.25 0 0 0-2.25-2.25h-.75m0-3-3-3m0 0-3 3m3-3v11.25m6-2.25h.75a2.25 2.25 0 0 1 2.25 2.25v7.5a2.25 2.25 0 0 1-2.25 2.25h-7.5a2.25 2.25 0 0 1-2.25-2.25v-.75"})}),e.jsx("input",{disabled:s,ref:n,id:"audio_file",style:{display:"none"},type:"file",directory:"",webkitdirectory:"",multiple:!0,accept:"audio/*, .wav, .mp3, .m4a, .flac, .aac, .ogg",onChange:()=>{a()}}),s?"importing...":"import sounds folder"]})})}const Gt={ASSETS_PREFIX:void 0,BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SITE:"https://strudel.cc/",SSR:!1},fe=t=>Array.isArray(t)?t.length:typeof t=="object"?Object.values(t).length:1;function Xt(){const t=Q(ue),{soundsFilter:n}=N(),[s,r]=m.useState(""),{BASE_URL:a}=Gt,c=a.endsWith("/")?a.slice(0,-1):a,h=m.useMemo(()=>{if(!t)return[];let i=Object.entries(t).filter(([o])=>!o.startsWith("_")).sort((o,u)=>o[0].localeCompare(u[0])).filter(([o])=>o.toLowerCase().includes(s.toLowerCase()));return n===_.USER?i.filter(([o,{data:u}])=>!u.prebake):n===_.DRUMS?i.filter(([o,{data:u}])=>u.type==="sample"&&u.tag==="drum-machines"):n===_.SAMPLES?i.filter(([o,{data:u}])=>u.type==="sample"&&u.tag!=="drum-machines"):n===_.SYNTHS?i.filter(([o,{data:u}])=>["synth","soundfont"].includes(u.type)):n===_.WAVETABLES?i.filter(([o,{data:u}])=>u.type==="wavetable"):n==="importSounds"?[]:i},[t,n,s]),d=m.useRef();let f=0;return ye("mouseup",()=>{const i=d.current;d.current=void 0,i?.then(o=>{o?.stop(me().currentTime+.01)})}),e.jsxs("div",{id:"sounds-tab",className:"px-4 flex gap-2 flex-col w-full h-full text-foreground",style:{direction:"rtl",textAlign:"right"},children:[e.jsx(te,{placeholder:"Ø¬Ø³ØªØ¬Ùˆ",value:s,onChange:i=>r(i)}),e.jsx("div",{className:" flex shrink-0 flex-wrap",children:e.jsx(K,{value:n,onChange:i=>g.setKey("soundsFilter",i),items:{samples:"samples",drums:"drum-machines",synths:"Synths",wavetables:"Wavetables",user:"User",importSounds:"import-sounds"}})}),n===_.USER&&h.length>0&&e.jsx(it,{className:"pl-2",label:"delete-all",onClick:async()=>{try{await M("Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ Ø³Ù…Ù¾Ù„â€ŒÙ‡Ø§ÛŒ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ")&&(Ve(q.dbName),ue.set({}),await ee())}catch(i){console.error(i)}}}),e.jsxs("div",{className:"min-h-0 max-h-full grow overflow-auto Â text-sm break-normal bg-background p-2 rounded-md",children:[h.map(([i,{data:o,onTrigger:u}])=>e.jsxs("span",{className:"cursor-pointer hover:opacity-50",onMouseDown:async()=>{const p=me(),b={note:["synth","soundfont"].includes(o.type)?"a3":void 0,s:i,n:f,clip:1,release:.5,sustain:1,duration:.5};f++;const S=p.currentTime+.05,k=()=>d.current?.node?.disconnect();d.current=Promise.resolve(u(S,b,k)),d.current.then(P=>{yt(P?.node)})},children:[" ",i,o?.type==="sample"?`(${fe(o.samples)})`:"",o?.type==="wavetable"?`(${fe(o.tables)})`:"",o?.type==="soundfont"?`(${o.fonts.length})`:""]},i)),!h.length&&n==="importSounds"?e.jsxs("div",{className:"prose dark:prose-invert min-w-full pt-2 pb-8 px-4",style:{textAlign:"right"},children:[e.jsx(Vt,{onComplete:()=>g.setKey("soundsFilter","user")}),e.jsxs("p",{children:["Ø¨Ø±Ø§ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† ØµØ¯Ø§Ù‡Ø§ Ø¨Ù‡ StrudelØŒ Ø¢Ù†Ù‡Ø§ Ø¨Ø§ÛŒØ¯"," ",e.jsx("a",{href:`${c}/learn/samples/#from-disk-via-import-sounds-folder`,target:"_blank",children:"Ø¯Ø±ÙˆÙ† ÛŒÚ© Ù¾ÙˆØ´Ù‡ ÛŒØ§ Ø²ÛŒØ±Ù¾ÙˆØ´Ù‡"}),'Ù‚Ø±Ø§Ø± Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù†Ø¯. Ø¨Ù‡ØªØ±ÛŒÙ† Ø±ÙˆØ´ Ø§ÛŒÙ† Ø§Ø³Øª Ú©Ù‡ ÛŒÚ© Ù¾ÙˆØ´Ù‡ "samples" Ø±Ø§ Ú©Ù‡ Ø­Ø§ÙˆÛŒ Ø²ÛŒØ±Ù¾ÙˆØ´Ù‡â€ŒÙ‡Ø§ÛŒÛŒ Ø§Ø² ØµØ¯Ø§Ù‡Ø§ÛŒ Ù…Ø¬Ø²Ø§ ÛŒØ§ Ø¨Ø§Ù†Ú©â€ŒÙ‡Ø§ÛŒ ØµÙˆØªÛŒ Ø§Ø³ØªØŒ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯ (Ù†Ù…ÙˆØ¯Ø§Ø± Ø²ÛŒØ± Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯).']}),e.jsx("pre",{className:"bg-background",style:{textAlign:"left",direction:"ltr"},children:`â””â”€ samples <-- import this folder
    â”œâ”€ swoop
    â”‚ Â â”œâ”€ swoopshort.wav
    â”‚ Â â”œâ”€ swooplong.wav
    â”‚ Â â””â”€ swooptight.wav
    â””â”€ smash
      â”œâ”€ smashhigh.wav
      â”œâ”€ smashlow.wav
      â””â”€ smashmiddle.wav`},"sample-diagram"),e.jsx("p",{children:'Ù†Ø§Ù… ÛŒÚ© Ø²ÛŒØ±Ù¾ÙˆØ´Ù‡ Ø¨Ø§ Ù†Ø§Ù… ØµØ¯Ø§ Ø¯Ø± ØªØ¨ "User" Ù…Ø·Ø§Ø¨Ù‚Øª Ø¯Ø§Ø±Ø¯. Ú†Ù†Ø¯ÛŒÙ† Ø³Ù…Ù¾Ù„ Ø¯Ø± ÛŒÚ© Ø²ÛŒØ±Ù¾ÙˆØ´Ù‡ Ù‡Ù…Ú¯ÛŒ Ø¨Ø§ ÛŒÚ© Ù†Ø§Ù… Ø¨Ø±Ú†Ø³Ø¨â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ØŒ Ø§Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…ØªØ¯ "n( )" Ø¨Ù‡ Ø¢Ù†Ù‡Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯ - Ø¨Ù‡ Ø®Ø§Ø·Ø± Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ ØµØ¯Ø§Ù‡Ø§ Ø¨Ø§ Ø§Ù†Ø¯ÛŒØ³ ØµÙØ± Ø´Ø±ÙˆØ¹ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ùˆ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ±ØªÛŒØ¨ Ø§Ù„ÙØ¨Ø§ÛŒÛŒ Ù…Ø±ØªØ¨ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯!'}),e.jsxs("p",{children:["Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ± Ùˆ Ø³Ø§ÛŒØ± Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØµØ¯Ø§Ù‡Ø§ÛŒ Ø®ÙˆØ¯ Ø¯Ø± StrudelØŒ"," ",e.jsx("a",{href:`${c}/learn/samples/#from-disk-via-import-sounds-folder`,target:"_blank",children:"Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯"}),"!"]}),e.jsx("h3",{children:"Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ØµØ¯Ø§Ù‡Ø§"}),e.jsx("pre",{className:"bg-background",style:{textAlign:"left",direction:"ltr"},children:'n("0 1 2 3 4 5").s("sample-name")'},"sample-preview"),e.jsx("p",{children:'Ø®Ø· Ø¨Ø§Ù„Ø§ Ø±Ø§ Ø¯Ø± ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ø§ØµÙ„ÛŒ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯ ØªØ§ Ù¾ÙˆØ´Ù‡ Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯Ù‡ Ø±Ø§ Ø¨Ø´Ù†ÙˆÛŒØ¯. Ø¨Ù‡ ÛŒØ§Ø¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ø§Ø² Ù†Ø§Ù… Ø³Ù…Ù¾Ù„ Ø®ÙˆØ¯ Ú©Ù‡ Ø¯Ø± ØªØ¨ "User" Ø¸Ø§Ù‡Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.'})]}):"",!h.length&&n!=="importSounds"?"Ù‡ÛŒÚ† ØµØ¯Ø§ÛŒÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª":""]})]})}const qt={ASSETS_PREFIX:void 0,BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SITE:"https://strudel.cc/",SSR:!1},{BASE_URL:G}=qt,Yt=G.endsWith("/")?G.slice(0,-1):G;function Jt({context:t}){const{fontFamily:n}=N();return e.jsxs("div",{className:"prose dark:prose-invert min-w-full pt-2 font-sans pb-8 px-4 ",style:{fontFamily:n,direction:"rtl",textAlign:"right"},children:[e.jsx("h3",{children:"ê©œ welcome"}),e.jsxs("p",{children:[e.jsx("span",{className:"underline",children:"strudel"}),"   ÛŒÚ© Ù¾Ù„ØªÙØ±Ù… Ø¬Ø¯ÛŒØ¯ Ù„Ø§ÛŒÙˆ Ú©Ø¯ÛŒÙ†Ú¯ (Ú©Ø¯Ù†ÙˆÛŒØ³ÛŒ Ø²Ù†Ø¯Ù‡) Ø¨Ø±Ø§ÛŒ Ù†ÙˆØ´ØªÙ† Ù‚Ø·Ø¹Ø§Øª Ù…ÙˆØ³ÛŒÙ‚ÛŒ Ù¾ÙˆÛŒØ§ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø±! Ø§ÛŒÙ† Ù¾Ù„ØªÙØ±Ù… Ø±Ø§ÛŒÚ¯Ø§Ù† Ùˆ Ù…ØªÙ†â€ŒØ¨Ø§Ø² Ø§Ø³Øª Ùˆ Ù‡Ù… Ø¨Ø±Ø§ÛŒ Ù…Ø¨ØªØ¯ÛŒØ§Ù† Ùˆ Ù‡Ù… Ø¨Ø±Ø§ÛŒ Ù…ØªØ®ØµØµØ§Ù† Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹:",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"underline",children:"1. hit play"})," - ",e.jsx("span",{className:"underline",children:"2. change something"})," -"," ",e.jsx("span",{className:"underline",children:"3. hit update"})]}),e.jsxs("p",{children:["Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ Ù†Ú¯Ø§Ù‡ÛŒ Ø¨Ù‡"," ",e.jsx("a",{href:`${Yt}/workshop/getting-started/`,target:"_blank",children:"interactive tutorial"}),". Ù‡Ù…Ú†Ù†ÛŒÙ† Ø±Ø§Ø­Øª Ø¨Ø§Ø´ÛŒØ¯ ØªØ§ Ø¨Ù‡"," ",e.jsx("a",{href:"https://discord.com/invite/HGEdXmRkzT",target:"_blank",children:"discord channel"})," ","Ù…Ø§ Ø¨Ù¾ÛŒÙˆÙ†Ø¯ÛŒØ¯ ØªØ§ Ù‡Ø± Ø³ÙˆØ§Ù„ÛŒ Ø¯Ø§Ø±ÛŒØ¯ Ø¨Ù¾Ø±Ø³ÛŒØ¯ØŒ Ø¨Ø§Ø²Ø®ÙˆØ±Ø¯ Ø¨Ø¯Ù‡ÛŒØ¯ ÛŒØ§ ÙÙ‚Ø· Ø³Ù„Ø§Ù… Ú©Ù†ÛŒØ¯."]}),e.jsx("h3",{children:"ê©œ about"}),e.jsxs("p",{children:["strudel ÛŒÚ© Ù†Ø³Ø®Ù‡ Ø¬Ø§ÙˆØ§ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§Ø²"," ",e.jsx("a",{href:"https://tidalcycles.org/",target:"_blank",children:"tidalcycles"}),"Ø§Ø³ØªØŒ Ú©Ù‡ ÛŒÚ© Ø²Ø¨Ø§Ù† Ù„Ø§ÛŒÙˆ Ú©Ø¯ÛŒÙ†Ú¯ Ù…Ø­Ø¨ÙˆØ¨ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ³ÛŒÙ‚ÛŒØŒ Ù†ÙˆØ´ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§ Haskell Ø§Ø³Øª. Strudel ÛŒÚ© Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø± Ø±Ø§ÛŒÚ¯Ø§Ù†/Ù…ØªÙ†â€ŒØ¨Ø§Ø² Ø§Ø³Øª: Ø´Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¢Ù† Ø±Ø§ ØªØ­Øª Ø´Ø±Ø§ÛŒØ·"," ",e.jsx("a",{href:"https://codeberg.org/uzu/strudel/src/branch/main/LICENSE",target:"_blank",children:"GNU Affero General Public License"}),"Ø¨Ø§Ø²Ù†Ø´Ø± Ùˆ/ÛŒØ§ Ø§ØµÙ„Ø§Ø­ Ú©Ù†ÛŒØ¯. Ø´Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø³ÙˆØ±Ø³ Ú©Ø¯ Ø±Ø§ Ø¯Ø±"," ",e.jsx("a",{href:"https://codeberg.org/uzu/strudel",target:"_blank",children:"codeberg"}),"Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯. Ù‡Ù…Ú†Ù†ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ",e.jsx("a",{href:"https://github.com/felixroos/dough-samples/blob/main/README.md",children:"licensing info"})," ","Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ù†Ú©â€ŒÙ‡Ø§ÛŒ ØµØ¯Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø¯Ø± Ø¢Ù†Ø¬Ø§ Ø¨ÛŒØ§Ø¨ÛŒØ¯. Ù„Ø·ÙØ§Ù‹ Ø¨Ø±Ø§ÛŒ ØªØ¶Ù…ÛŒÙ† ØªÙˆØ³Ø¹Ù‡ Ù…Ø¯Ø§ÙˆÙ…ØŒ"," ",e.jsx("a",{href:"https://opencollective.com/tidalcycles",target:"_blank",children:"support this project"})," ","Ø±Ø§ Ø¯Ø± Ù†Ø¸Ø± Ø¨Ú¯ÛŒØ±ÛŒØ¯ ðŸ’–"]})]})}function Qt({title:t,titleId:n,...s},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?m.createElement("title",{id:n},t):null,m.createElement("path",{fillRule:"evenodd",d:"M9.78 4.22a.75.75 0 0 1 0 1.06L7.06 8l2.72 2.72a.75.75 0 1 1-1.06 1.06L5.47 8.53a.75.75 0 0 1 0-1.06l3.25-3.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"}))}const en=m.forwardRef(Qt);function tn({title:t,titleId:n,...s},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?m.createElement("title",{id:n},t):null,m.createElement("path",{d:"M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"}))}const nn=m.forwardRef(tn),sn=typeof window<"u"&&window.__TAURI__;function Ne({context:t}){const n=N(),{isPanelOpen:s,activeFooter:r}=n;return e.jsxs(Te,{settings:n,className:v(s?"min-h-[360px] max-h-[360px]":"min-h-12 max-h-12","overflow-hidden flex flex-col"),children:[s&&e.jsx("div",{className:"flex h-full overflow-auto pr-10 ",children:e.jsx(Se,{context:t,tab:r})}),e.jsx("div",{className:"absolute right-4 pt-4",children:e.jsx(Pe,{settings:n})}),e.jsx("div",{className:"flex  justify-between min-h-12 max-h-12 grid-cols-2 items-center",children:e.jsx(ke,{setTab:je,tab:r})})]})}function rn({context:t}){const n=N(),{activeFooter:s,isPanelOpen:r}=n;return e.jsx(Te,{settings:n,className:v(r?"min-w-[min(600px,80vw)] max-w-[min(600px,80vw)]":"min-w-12 max-w-12"),children:r?e.jsxs("div",{className:v("flex flex-col h-full"),children:[e.jsxs("div",{className:"flex justify-between w-full ",children:[e.jsx(ke,{setTab:je,tab:s}),e.jsx(Pe,{settings:n})]}),e.jsx("div",{className:"overflow-auto h-full",children:e.jsx(Se,{context:t,tab:s})})]}):e.jsx("button",{onClick:a=>{D(!0)},"aria-label":"open menu panel",className:v("flex flex-col hover:bg-lineBackground items-center cursor-pointer justify-center w-full  h-full"),children:e.jsx(en,{className:"text-foreground opacity-50 w-6 h-6"})})})}const T={welcome:"intro",patterns:"patterns",sounds:"sounds",reference:"reference",console:"console",settings:"settings"};sn&&(T.files="files");function Te({children:t,className:n,settings:s,...r}){const a=s.togglePanelTrigger==="hover";return e.jsx("nav",{onClick:()=>{s.isPanelOpen||D(!0)},onMouseEnter:()=>{a&&!s.isPanelOpen&&D(!0)},onMouseLeave:()=>{a&&!s.isPanelPinned&&D(!1)},"aria-label":"Menu Panel",className:v("bg-lineHighlight group overflow-x-auto",n),...r,children:t})}function Se({context:t,tab:n}){switch(At(),n){case T.patterns:return e.jsx(lt,{context:t});case T.console:return e.jsx(Mt,{});case T.sounds:return e.jsx(Xt,{});case T.reference:return e.jsx(Bt,{});case T.settings:return e.jsx(Zt,{started:t.started});case T.files:return e.jsx(Dt,{});default:return e.jsx(Jt,{context:t})}}function an({label:t,isSelected:n,onClick:s}){return e.jsx(e.Fragment,{children:e.jsx("button",{onClick:s,className:v("h-8 px-2 text-foreground cursor-pointer hover:opacity-50 flex items-center space-x-1 border-b",n?"border-foreground":"border-transparent"),children:t})})}function ke({setTab:t,tab:n,className:s}){return e.jsx("div",{className:v("flex select-none max-w-full overflow-auto pb-2",s),children:Object.keys(T).map(r=>{const a=T[r];return e.jsx(an,{isSelected:n===a,label:r,onClick:()=>t(a)},r)})})}function Pe({settings:t}){const{togglePanelTrigger:n,isPanelPinned:s,isPanelOpen:r}=t,a=n==="hover";if(r)return a?e.jsx(on,{pinned:s}):e.jsx(ln,{onClick:()=>D(!1)})}function on({pinned:t}){return e.jsx("button",{onClick:()=>Ge(!t),className:v("text-foreground max-h-8 min-h-8 max-w-8 min-w-8 items-center justify-center p-1.5 group-hover:flex",t?"flex":"hidden"),"aria-label":"Pin Menu Panel",children:e.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",className:"w-full h-full",opacity:t?1:".3",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a6 6 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182c-.195.195-1.219.902-1.414.707s.512-1.22.707-1.414l3.182-3.182-2.828-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a6 6 0 0 1 1.013.16l3.134-3.133a3 3 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146"})})})}function ln({onClick:t}){return e.jsx("button",{onClick:t,className:v("text-foreground max-h-8 min-h-8 max-w-8 min-w-8 items-center justify-center p-1.5 group-hover:flex"),"aria-label":"Close Menu",children:e.jsx(nn,{})})}function se(t){const{editorRef:n,containerRef:s,init:r}=t;return e.jsx("section",{className:"text-gray-100 cursor-text pb-0 overflow-auto grow",id:"code",ref:a=>{s.current=a,n.current||r()}})}function cn({title:t,titleId:n,...s},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?m.createElement("title",{id:n},t):null,m.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm6.39-2.908a.75.75 0 0 1 .766.027l3.5 2.25a.75.75 0 0 1 0 1.262l-3.5 2.25A.75.75 0 0 1 8 12.25v-4.5a.75.75 0 0 1 .39-.658Z",clipRule:"evenodd"}))}const Re=m.forwardRef(cn);function _e(t){const{started:n,handleTogglePlay:s}=t;if(!n)return e.jsxs("button",{onClick:()=>s(),className:"text-white text-2xl fixed left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%] z-[1000] m-auto p-4 bg-black rounded-md flex items-center space-x-2",children:[e.jsx(Re,{className:"w-6 h-6"}),e.jsx("span",{children:"play"})]})}function re(t){const{error:n}=t;if(n!=null)return e.jsxs("div",{className:"text-background px-2 py-1 bg-foreground w-full ml-auto",children:["Error: ",n.message||"Unknown Error :-/"]})}function dn(t){const{context:n,...s}=t,{containerRef:r,editorRef:a,error:c,init:h,pending:d,started:f,handleTogglePlay:i}=n;return e.jsxs("div",{className:"h-full flex w-full flex-col relative",...s,children:[e.jsx(ne,{active:d}),e.jsx(_e,{started:f,handleTogglePlay:i}),e.jsx("div",{className:"grow flex relative overflow-hidden",children:e.jsx(se,{containerRef:r,editorRef:a,init:h})}),e.jsx(re,{error:c}),e.jsx(Ne,{context:n})]})}function un({title:t,titleId:n,...s},r){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},s),t?m.createElement("title",{id:n},t):null,m.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm5-2.25A.75.75 0 0 1 7.75 7h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-4.5Z",clipRule:"evenodd"}))}const mn=m.forwardRef(un),hn={ASSETS_PREFIX:void 0,BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SITE:"https://strudel.cc/",SSR:!1},{BASE_URL:X}=hn,ge=X.endsWith("/")?X.slice(0,-1):X;function Ae({context:t,embedded:n=!1}){const{started:s,pending:r,isDirty:a,activeCode:c,handleTogglePlay:h,handleEvaluate:d,handleShuffle:f,handleShare:i}=t,o=typeof window<"u"&&(n||window.location!==window.parent.location),{isZen:u,isButtonRowHidden:p,isCSSAnimationDisabled:b,fontFamily:S}=N();return e.jsxs("header",{id:"header",className:v("flex-none text-black  z-[100] text-lg select-none h-20 md:h-14",!u&&!o&&"bg-lineHighlight",u?"h-12 w-8 fixed top-0 left-0":"sticky top-0 w-full py-1 justify-between",o?"flex":"md:flex"),style:{fontFamily:S},children:[e.jsx("div",{className:"px-4 flex space-x-2 md:pt-0 select-none",children:e.jsxs("h1",{onClick:()=>{o&&window.open(window.location.href.replace("embed",""))},className:v(o?"text-l cursor-pointer":"text-xl","text-foreground font-bold flex space-x-2 items-center"),children:[e.jsx("div",{className:v("mt-[1px]",s&&!b&&"animate-spin","cursor-pointer text-blue-500",u&&"fixed top-2 right-4"),onClick:()=>{o||Xe(!u)},children:e.jsx("span",{className:"block text-foreground rotate-90",children:"ê©œ"})}),!u&&e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{className:"",children:"strudel"}),e.jsx("span",{className:"text-sm font-medium",children:"REPL"}),!o&&p&&e.jsx("a",{href:`${ge}/learn`,className:"text-sm opacity-25 font-medium",children:"DOCS"})]})]})}),!u&&!p&&e.jsxs("div",{className:"flex max-w-full overflow-auto text-foreground px-1 md:px-2",children:[e.jsx("button",{onClick:h,title:s?"stop":"play",className:v(o?"px-2":"p-2","hover:opacity-50",!s&&!b&&"animate-pulse"),children:r?e.jsx(e.Fragment,{children:"loading..."}):e.jsxs("span",{className:v("flex items-center space-x-2"),children:[s?e.jsx(mn,{className:"w-6 h-6"}):e.jsx(Re,{className:"w-6 h-6"}),!o&&e.jsx("span",{children:s?"stop":"play"})]})}),e.jsx("button",{onClick:d,title:"update",className:v("flex items-center space-x-1",o?"px-2":"p-2",!a||!c?"opacity-50":"hover:opacity-50"),children:!o&&e.jsx("span",{children:"update"})}),!o&&e.jsx("button",{title:"share",className:v("cursor-pointer hover:opacity-50 flex items-center space-x-1",o?"px-2":"p-2"),onClick:i,children:e.jsx("span",{children:"share"})}),!o&&e.jsx("a",{title:"learn",href:`${ge}/workshop/getting-started/`,className:v("hover:opacity-50 flex items-center space-x-1",o?"px-2":"p-2"),children:e.jsx("span",{children:"learn"})})]})]})}function pn(t){const{context:n,...s}=t,{containerRef:r,editorRef:a,error:c,init:h,pending:d}=n,f=N(),{panelPosition:i,isZen:o}=f;return e.jsxs("div",{className:"h-full flex flex-col relative",...s,children:[e.jsx(ne,{active:d}),e.jsx(Ae,{context:n}),e.jsxs("div",{className:"grow flex relative overflow-hidden",children:[e.jsx(se,{containerRef:r,editorRef:a,init:h}),!o&&i==="right"&&e.jsx(rn,{context:n})]}),e.jsx(re,{error:c}),!o&&i==="bottom"&&e.jsx(Ne,{context:n})]})}function fn(t){const{context:n,...s}=t,{pending:r,started:a,handleTogglePlay:c,containerRef:h,editorRef:d,error:f,init:i}=n;return e.jsxs("div",{className:"h-full flex flex-col relative",...s,children:[e.jsx(ne,{active:r}),e.jsx(Ae,{context:n,embedded:!0}),e.jsx(_e,{started:a,handleTogglePlay:c}),e.jsx("div",{className:"grow flex relative overflow-hidden",children:e.jsx(se,{containerRef:h,editorRef:d,init:i})}),e.jsx(re,{error:f})]})}const gn=Pt,xn=(t,n,s,r,a)=>{const c=performance.now()/1e3;return gn(t,c,r,a)},bn=t=>(n,s)=>(t.set(n,s),s),xe=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,Me=536870912,be=Me*2,vn=(t,n)=>s=>{const r=n.get(s);let a=r===void 0?s.size:r<be?r+1:0;if(!s.has(a))return t(s,a);if(s.size<Me){for(;s.has(a);)a=Math.floor(Math.random()*be);return t(s,a)}if(s.size>xe)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;s.has(a);)a=Math.floor(Math.random()*xe);return t(s,a)},Oe=new WeakMap,wn=bn(Oe),U=vn(wn,Oe),jn=t=>t.method!==void 0&&t.method==="call",yn=t=>typeof t.id=="number"&&typeof t.result=="boolean",Cn=t=>{const n=new Map([[0,()=>{}]]),s=new Map([[0,()=>{}]]),r=new Map,a=new Worker(t);return a.addEventListener("message",({data:i})=>{if(jn(i)){const{params:{timerId:o,timerType:u}}=i;if(u==="interval"){const p=n.get(o);if(typeof p===void 0)throw new Error("The timer is in an undefined state.");if(typeof p=="number"){const b=r.get(p);if(b===void 0||b.timerId!==o||b.timerType!==u)throw new Error("The timer is in an undefined state.")}else typeof p=="function"&&p()}else if(u==="timeout"){const p=s.get(o);if(typeof p===void 0)throw new Error("The timer is in an undefined state.");if(typeof p=="number"){const b=r.get(p);if(b===void 0||b.timerId!==o||b.timerType!==u)throw new Error("The timer is in an undefined state.")}else typeof p=="function"&&(p(),s.delete(o))}}else if(yn(i)){const{id:o}=i,u=r.get(o);if(u===void 0)throw new Error("The timer is in an undefined state.");const{timerId:p,timerType:b}=u;r.delete(o),b==="interval"?n.delete(p):s.delete(p)}else{const{error:{message:o}}=i;throw new Error(o)}}),{clearInterval:i=>{if(typeof n.get(i)=="function"){const o=U(r);r.set(o,{timerId:i,timerType:"interval"}),n.set(i,o),a.postMessage({id:o,method:"clear",params:{timerId:i,timerType:"interval"}})}},clearTimeout:i=>{if(typeof s.get(i)=="function"){const o=U(r);r.set(o,{timerId:i,timerType:"timeout"}),s.set(i,o),a.postMessage({id:o,method:"clear",params:{timerId:i,timerType:"timeout"}})}},setInterval:(i,o=0,...u)=>{const p=U(n);return n.set(p,()=>{i(...u),typeof n.get(p)=="function"&&a.postMessage({id:null,method:"set",params:{delay:o,now:performance.timeOrigin+performance.now(),timerId:p,timerType:"interval"}})}),a.postMessage({id:null,method:"set",params:{delay:o,now:performance.timeOrigin+performance.now(),timerId:p,timerType:"interval"}}),p},setTimeout:(i,o=0,...u)=>{const p=U(s);return s.set(p,()=>i(...u)),a.postMessage({id:null,method:"set",params:{delay:o,now:performance.timeOrigin+performance.now(),timerId:p,timerType:"timeout"}}),p}}},En=(t,n)=>{let s=null;return()=>{if(s!==null)return s;const r=new Blob([n],{type:"application/javascript; charset=utf-8"}),a=URL.createObjectURL(r);return s=t(a),setTimeout(()=>URL.revokeObjectURL(a)),s}},Nn=`(()=>{"use strict";const e=new Map,t=new Map,r=t=>{const r=e.get(t);return void 0!==r&&(clearTimeout(r),e.delete(t),!0)},s=e=>{const r=t.get(e);return void 0!==r&&(clearTimeout(r),t.delete(e),!0)},o=(e,t)=>{const r=performance.now(),s=e+t-r-performance.timeOrigin;return{expected:r+s,remainingDelay:s}},i=(e,t,r,s)=>{const o=r-performance.now();o>0?e.set(t,setTimeout(i,o,e,t,r,s)):(e.delete(t),postMessage({id:null,method:"call",params:{timerId:t,timerType:s}}))};addEventListener("message",(({data:n})=>{try{if("clear"===n.method){const{id:e,params:{timerId:t,timerType:o}}=n;if("interval"===o)postMessage({id:e,result:r(t)});else{if("timeout"!==o)throw new Error('The given type "'.concat(o,'" is not supported'));postMessage({id:e,result:s(t)})}}else{if("set"!==n.method)throw new Error('The given method "'.concat(n.method,'" is not supported'));{const{params:{delay:r,now:s,timerId:a,timerType:m}}=n;if("interval"===m)((t,r,s)=>{const{expected:n,remainingDelay:a}=o(t,s);e.set(r,setTimeout(i,a,e,r,n,"interval"))})(r,a,s);else{if("timeout"!==m)throw new Error('The given type "'.concat(m,'" is not supported'));((e,r,s)=>{const{expected:n,remainingDelay:a}=o(e,s);t.set(r,setTimeout(i,a,t,r,n,"timeout"))})(r,a,s)}}}}catch(e){postMessage({error:{message:e.message},id:n.id,result:null})}}))})();`,De=En(Cn,Nn),Tn=t=>De().clearInterval(t),Sn=(...t)=>De().setInterval(...t),{latestCode:ve,maxPolyphony:kn,audioDeviceName:Pn,multiChannelOrbits:Rn}=g.get();let W,Le,H,Ie,Fe;typeof window<"u"&&(Fe=Ct({maxPolyphony:kn,audioDeviceName:Pn,multiChannelOrbits:Ye(Rn)}),W=qe(),Le=ee(),H=Ce(),Ie=()=>H.clearRect(0,0,H.canvas.height,H.canvas.width));async function _n(t){return W?(await W).find(s=>s.packageName===t):void 0}const An="// LOADING";function Mn(){const{isSyncEnabled:t,audioEngineTarget:n}=N(),s=n!==A.osc,r=s?Et:xn,a=s?Nt:ut,c=m.useCallback(()=>{const w=[-2,2],j=Ce(),O=new gt({sync:t,defaultOutput:r,getTime:a,setInterval:Sn,clearInterval:Tn,transpiler:xt,autodraw:!1,root:S.current,initialCode:An,pattern:ct,drawTime:w,drawContext:j,prebake:async()=>Promise.all([W,Le]),onUpdateState:l=>{d({...l})},onToggle:l=>{l||he()},beforeEval:()=>Fe,afterEval:l=>{const{code:x}=l;window.parent?.postMessage(x),Je(x),window.location.hash="#"+dt(x),P(x);const E=Qe();et(x);const V={...E,code:x};let R=V.id;if(E.collection!==F.collection){if(x!==E.code){const le=F.duplicate(V);R=le.id,B(le.data)}}else R=F.isValidID(R)?R:tt(),B(F.update(R,V).data);ce(R)},bgFill:!1});window.strudelMirror=O,nt().then(async l=>{let x,E;l?(x=l,E="I have loaded the code from the URL."):ve?(x=ve,E="Your last session has been loaded!"):(x='$: s("[bd <hh oh>]*2").bank("tr909").dec(.4)',E="Default code has been loaded"),O.setCode(x),P(x),Y(`Welcome to Strudel! ${E} Press play or hit ctrl+enter to run it!`,"highlight")}),b.current=O},[]),[h,d]=m.useState({}),{started:f,isDirty:i,error:o,activeCode:u,pending:p}=h,b=m.useRef(),S=m.useRef(),k=Q(g,{keys:Object.keys(de)});m.useEffect(()=>{let w={};Object.keys(de).forEach(j=>{Object.prototype.hasOwnProperty.call(k,j)&&(w[j]=k[j])}),b.current?.updateSettings(w)},[k]);const P=w=>{const j=st(w);document.title=(j.title?`${j.title} - `:"")+"Strudel REPL"},z=async()=>{b.current?.toggle()},L=async()=>{(await _n("@strudel/tonal"))?.resetVoicings(),Tt(),St(),Ie(),he(),kt(),b.current.repl.setCps(.5),await ee()},Z=async(w,j=!1)=>{B(w),b.current.setCode(w.code),j&&(await L(),I())},I=()=>{b.current.evaluate()};return{started:f,pending:p,isDirty:i,activeCode:u,handleTogglePlay:z,handleUpdate:Z,handleShuffle:async()=>{const w=await rt(),j=w.code;Y(`[repl] âœ¨ loading random tune "${w.id}"`),ce(w.id),B(w),await L(),b.current.setCode(j),b.current.repl.evaluate(j)},handleShare:async()=>at(h.code),handleEvaluate:I,init:c,error:o,editorRef:b,containerRef:S}}function qn({embedded:t=!1}){const n=t||ot(),s=we()?dn:n?fn:pn,r=Mn(),{fontFamily:a}=N();return e.jsx(s,{context:r,style:{fontFamily:a}})}export{qn as Repl};
